# Story 2.6: Delete Exercise Log

## Status

Draft

## Story

**As a** developer,
**I want** a `DELETE /logs/exercise/{log_id}` endpoint,
**so that** a client application can permanently delete a previously recorded `ExerciseLog`.

## Acceptance Criteria

1.  A `DELETE` request to `/logs/exercise/{log_id}` permanently deletes the specified `ExerciseLog` from the database.
2.  A successful deletion returns a `204 No Content` HTTP status code with an empty response body.
3.  The endpoint must be protected, returning `401 Unauthorized` if the user is not authenticated.
4.  If the `log_id` does not exist, the endpoint must return a `404 Not Found`.
5.  If the authenticated user is not the owner of the log, the endpoint must return a `403 Forbidden`.

## Tasks / Subtasks

*   `[ ]` **Task 1: Implement the `DELETE /logs/exercise/{log_id}` endpoint.** (AC: #1, #2, #3)
    *   `[ ]` Subtask 1.1: Add the new `DELETE` endpoint with a `log_id` path parameter to the `apps/api/routers/exercise_logs.py` router.
    *   `[ ]` Subtask 1.2: Ensure the endpoint is protected by the `get_current_user` dependency and returns a `204 No Content` status on success.
*   `[ ]` **Task 2: Implement the delete service and repository logic.** (AC: #1, #4, #5)
    *   `[ ]` Subtask 2.1: Create a `delete_log` method in the `ExerciseLogService`.
    *   `[ ]` Subtask 2.2: The service must first fetch the `ExerciseLog` from the repository to verify its existence and ownership.
    *   `[ ]` Subtask 2.3: If the user is authorized, the service will call a `delete` method in the `ExerciseLogRepository`.
    *   `[ ]` Subtask 2.4: The repository method will perform the database deletion.
*   `[ ]` **Task 3: Write tests for the delete endpoint.**
    *   `[ ]` Subtask 3.1: Write an integration test for a successful deletion (204).
    *   `[ ]` Subtask 3.2: Write tests for the failure cases: `404 Not Found`, `403 Forbidden`, and `401 Unauthorized`.

## Dev Notes

*   **HTTP Status Code:** The standard and expected response for a successful `DELETE` operation is `204 No Content`. Ensure your FastAPI endpoint is configured to return this. You can do this by setting `status_code=204` in the decorator and having the function return `None`.
*   **Authorization First:** The service logic must fetch the entity and verify ownership *before* attempting the deletion. This prevents leaking information about the existence of logs that don't belong to the user.
*   **Dependencies:** The tests for this story will need to create a user, a workout, and an exercise log to have an entity to delete.

## Change Log

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-09-23 | 1.0 | Initial draft | Sarah |
