# Story 3.2: List Workout Templates

## Status

Draft

## Story

**As a** developer,
**I want** a `GET /workout-templates` endpoint,
**so that** a client application can retrieve a list of all `WorkoutTemplate`s created by the authenticated user.

## Acceptance Criteria

1.  A `GET` request to `/workout-templates` returns a `200 OK` status code with a list of `WorkoutTemplate` objects belonging to the authenticated user.
2.  The endpoint must be protected, returning a `401 Unauthorized` if no valid JWT is provided.
3.  The returned list of templates must be sorted by name in ascending alphabetical order.
4.  The endpoint must support pagination using `limit` and `offset` query parameters.
5.  The response body should be a JSON object containing the list of templates and pagination metadata (e.g., `total_count`, `limit`, `offset`).
6.  If the user has no templates, the endpoint should return a `200 OK` with an empty list.

## Tasks / Subtasks

*   `[ ]` **Task 1: Create Pydantic models for the paginated response.** (AC: #5)
    *   `[ ]` Subtask 1.1: Create a `PaginatedWorkoutTemplateResponse` model that includes a list of `WorkoutTemplateRead` models and fields for `total_count`, `limit`, and `offset`.
*   `[ ]` **Task 2: Implement the `GET /workout-templates` endpoint.** (AC: #1, #2, #4)
    *   `[ ]` Subtask 2.1: Add the new `GET` endpoint to the `apps/api/routers/workout_templates.py` router.
    *   `[ ]` Subtask 2.2: Implement `limit` and `offset` as query parameters with default values.
    *   `[ ]` Subtask 2.3: Ensure the endpoint is protected by the `get_current_user` dependency.
*   `[ ]` **Task 3: Implement the service and repository logic for fetching templates.** (AC: #1, #3, #6)
    *   `[ ]` Subtask 3.1: Create a `get_templates` method in the `WorkoutTemplateService`.
    *   `[ ]` Subtask 3.2: Create a `list_by_user` method in the `WorkoutTemplateRepository` that accepts `user_id`, `limit`, and `offset`.
    *   `[ ]` Subtask 3.3: The repository method must perform a query to fetch the paginated list of templates, ordered by name, and another query to get the total count for that user.
*   `[ ]` **Task 4: Write tests for the list templates endpoint.**
    *   `[ ]` Subtask 4.1: Write an integration test to verify that the endpoint returns a correctly sorted and paginated list of templates.
    *   `[ ]` Subtask 4.2: Write a test to verify that a user only sees their own templates.
    *   `[ ]` Subtask 4.3: Write a test for the case where a user has zero templates.

## Dev Notes

*   **Re-use Pagination Pattern:** This story follows the exact same pagination and repository logic as Story 2.3 (`list-workouts`). You can re-use the patterns for creating a paginated response model and for implementing the `list_by_user` method in the repository.
*   **Sorting:** The acceptance criteria specify sorting by name. Use `.order_by(models.WorkoutTemplate.name)` in your repository query.
*   **Dependencies:** The tests for this story will require at least one `WorkoutTemplate` to be created first in order to test the listing functionality.

## Change Log

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-09-23 | 1.0 | Initial draft | Sarah |
